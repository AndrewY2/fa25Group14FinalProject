@model IEnumerable<dynamic>

@{
    ViewData["Title"] = "Report A - All Books Sold";
}

<h2>All Books Sold</h2>

<p><strong>Record count:</strong> @ViewBag.RecordCount</p>

<table class="table table-striped table-sm">
    <thead>
        <tr>
            <th>Order #</th>
            <th>Book Title</th>
            <th>Customer</th>
            <th>Quantity</th>
            <th>Selling Price</th>
            <th>Average Cost</th>
            <th>Per-Unit Profit Margin</th>
            <th>Total Revenue</th>
            <th>Total Cost</th>
            <th>Total Profit</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var row in Model)
        {
            // Calculate totals per line (ignore shipping, per spec)
            decimal revenue = row.Quantity * row.SellingPrice;
            decimal cost = row.Quantity * row.WeightedAverageCost;
            decimal profit = revenue - cost;

            <tr>
                <td>@row.OrderNumber</td>
                <td>@row.BookTitle</td>
                <td>@row.CustomerName</td>
                <td>@row.Quantity</td>

                <td>@(((decimal)row.SellingPrice).ToString("C"))</td>
                <td>@(((decimal)row.WeightedAverageCost).ToString("C"))</td>
                <td>@(((decimal)row.ProfitMargin).ToString("C"))</td>

                <td>@revenue.ToString("C")</td>
                <td>@cost.ToString("C")</td>
                <td>@profit.ToString("C")</td>
            </tr>
        }
    </tbody>
</table>
